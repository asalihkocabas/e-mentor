<!doctype html>
<html lang="tr">

<head>
  <meta charset="utf-8" />
  <title>Sınav Oluştur | E-Mentor Sistemi</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta content="E-Mentor Sistemi için sınav oluşturma sayfası" name="description" />
  <meta content="Themesbrand" name="author" />
  <link rel="shortcut icon" href="assets/images/favicon.ico">

  <link href='https://cdn.jsdelivr.net/npm/boxicons@2.0.9/css/boxicons.min.css' rel='stylesheet'>
  <link href="assets/libs/choices.js/public/assets/styles/choices.min.css" rel="stylesheet" type="text/css" />
  <link rel="stylesheet" href="assets/libs/flatpickr/flatpickr.min.css">
  <link rel="stylesheet" href="assets/libs/twitter-bootstrap-wizard/prettify.css">

  <link rel="stylesheet" href="assets/css/preloader.min.css" type="text/css" />a
  <link href="assets/css/bootstrap.min.css" id="bootstrap-style" rel="stylesheet" type="text/css" />
  <link href="assets/css/icons.min.css" rel="stylesheet" type="text/css" />
  <link href="assets/css/app.min.css" id="app-style" rel="stylesheet" type="text/css" />

  <style>
    /* Choices.js dropdown menüsünün sihirbaz dışına taşabilmesi için eklendi */
    .twitter-bs-wizard-tab-content {
      overflow: visible;
    }
  </style>
</head>

<body data-topbar="dark">
<div id="layout-wrapper">
  <header id="page-topbar">
    <div class="navbar-header">
      <div class="d-flex">
        <div class="navbar-brand-box">
          <a href="../index.php" class="logo logo-light">
            <span class="logo-sm"><img src="assets/images/logo-sm.svg" alt="" height="30"></span>
            <span class="logo-lg"><img src="assets/images/logo-sm.svg" alt="" height="24"> <span class="logo-txt">E-Mentor</span></span>
          </a>
        </div>
        <button type="button" class="btn btn-sm px-3 font-size-16 header-item" id="vertical-menu-btn"><i class="fa fa-fw fa-bars"></i></button>
      </div>
      <div class="d-flex">
        <div class="dropdown d-inline-block">
          <button type="button" class="btn header-item bg-light-subtle border-start border-end" id="page-header-user-dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <img class="rounded-circle header-profile-user" src="https://fotograf.sabis.sakarya.edu.tr/Fotograf/196f69e4eed68a3717e67cc6db180f6d" alt="Header Avatar">
            <span class="d-none d-xl-inline-block ms-1 fw-medium">Kaan Buğra</span>
            <i class="mdi mdi-chevron-down d-none d-xl-inline-block"></i>
          </button>
          <div class="dropdown-menu dropdown-menu-end">
            <a class="dropdown-item" href="#"><i class="mdi mdi-face-profile font-size-16 align-middle me-1"></i> Profil</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="../cıkıs-yap.html"><i class="mdi mdi-logout font-size-16 align-middle me-1"></i> Çıkış</a>
          </div>
        </div>
      </div>
    </div>
  </header>

  <div class="vertical-menu">
    <div data-simplebar class="h-100">
      <div id="sidebar-menu">
        <ul class="metismenu list-unstyled" id="side-menu">
          <li class="menu-title" data-key="t-menu">Menü</li>
          <li class=""><a href="index.php"><i data-feather="home"></i><span>Ana Sayfa</span></a></li>
          <li class="menu-title" data-key="t-apps">Yönetim</li>
          <li class=""><a href="siniflarim.php" class="has-arrow"><i data-feather="users"></i><span>Sınıflarım</span></a>
            <ul class="sub-menu" aria-expanded="false">
              <li><a href="siniflarim.php">Sınıf Listesi</a></li>
            </ul>
          </li>
          <li class="mm-active"><a href="javascript: void(0);" class="has-arrow"><i data-feather="clipboard"></i><span>Sınav İşlemleri</span></a>
            <ul class="sub-menu" aria-expanded="false">
              <li><a href="sinav-olustur.php">Sınav Oluştur</a></li>
              <li><a href="sonuc-girisi.php">Sonuç Girişi</a></li>
              <li><a href="raporlar.php">Sınav Raporları</a></li>
            </ul>
          </li>
          <li class=""><a href="javascript: void(0);" class="has-arrow"><i data-feather="trello"></i><span>Ödev İşlemleri</span></a>
            <ul class="sub-menu" aria-expanded="false">
              <li><a href="odev-ver.php">Ödev Ata</a></li>
              <li><a href="odev-takip.php">Ödev Takibi</a></li>
            </ul>
          </li>
          <li class=""><a href="javascript: void(0);" class="has-arrow"><i data-feather="send"></i><span>Duyurular</span></a>
            <ul class="sub-menu" aria-expanded="false">
              <li><a href="duyuru-ekle.php">Duyuru Ekle</a></li>
              <li><a href="duyuru-yonetimi.php">Duyuru Yönetimi</a></li>
            </ul>
          </li>
          <li class=""><a href="javascript: void(0);" class="has-arrow"><i data-feather="folder"></i><span>İçerik Yönetimi</span></a>
            <ul class="sub-menu" aria-expanded="false">
              <li><a href="dosya-yukle.php">Dosya Yükle</a></li>
              <li><a href="icerik-kutuphanesi.php">İçerik Kütüphanesi</a></li>
            </ul>
          </li>
          <li class="menu-title" data-key="t-tools">Araçlar</li>
          <li class=""><a href="ders-programi.php"><i data-feather="calendar"></i><span>Ders Programı</span></a></li>
          <li class=""><a href="yardim.php"><i data-feather="help-circle"></i><span>Yardım & Destek</span></a></li>
        </ul>
      </div>
    </div>
  </div>

  <div class="main-content">
    <div class="page-content">
      <div class="container-fluid">
        <div class="row">
          <div class="col-12">
            <div class="page-title-box d-sm-flex align-items-center justify-content-between">
              <h4 class="mb-sm-0 font-size-18">Sınav Oluşturma Sihirbazı</h4>
              <div class="page-title-right">
                <ol class="breadcrumb m-0">
                  <li class="breadcrumb-item"><a href="javascript: void(0);">Sınav İşlemleri</a></li>
                  <li class="breadcrumb-item active">Yeni Sınav Oluştur</li>
                </ol>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-lg-12">
            <div class="card">
              <div class="card-body">
                <div id="progrss-wizard" class="twitter-bs-wizard">
                  <ul class="twitter-bs-wizard-nav nav nav-pills nav-justified">
                    <li class="nav-item">
                      <a href="#exam-details" class="nav-link active" data-toggle="tab">
                        <div class="step-icon" data-bs-toggle="tooltip" data-bs-placement="top" title="Sınav Detayları">
                          <i class="bx bx-detail"></i>
                        </div>
                      </a>
                    </li>
                    <li class="nav-item">
                      <a href="#add-questions" class="nav-link" data-toggle="tab">
                        <div class="step-icon" data-bs-toggle="tooltip" data-bs-placement="top" title="Soru Ekleme">
                          <i class="bx bx-pencil"></i>
                        </div>
                      </a>
                    </li>
                    <li class="nav-item">
                      <a href="#review-and-save" class="nav-link" data-toggle="tab">
                        <div class="step-icon" data-bs-toggle="tooltip" data-bs-placement="top" title="Önizleme ve Kaydet">
                          <i class="bx bx-check-double"></i>
                        </div>
                      </a>
                    </li>
                  </ul>
                  <div id="bar" class="progress mt-4">
                    <div class="progress-bar bg-success progress-bar-striped progress-bar-animated"></div>
                  </div>
                  <div class="tab-content twitter-bs-wizard-tab-content">
                    <div class="tab-pane active" id="exam-details">
                      <div class="text-center my-4">
                        <h5>Sınav Detayları</h5>
                        <p class="card-title-desc">Lütfen sınavın temel bilgilerini seçiniz</p>
                      </div>
                      <form>
                        <div class="row">
                          <div class="col-lg-6">
                            <div class="mb-3">
                              <label for="choices-term" class="form-label">Dönem</label>
                              <select class="form-control" name="choices-term" id="choices-term">
                                <option value="1. Dönem">1. Dönem</option>
                                <option value="2. Dönem">2. Dönem</option>
                              </select>
                            </div>
                          </div>
                          <div class="col-lg-6">
                            <div class="mb-3">
                              <label for="choices-exam-type" class="form-label">Sınav Türü</label>
                              <select class="form-control" name="choices-exam-type" id="choices-exam-type">
                                <option value="1. Sınav">1. Sınav</option>
                                <option value="2. Sınav">2. Sınav</option>
                                <option value="Ara Sınav">Ara Sınav</option>
                                <option value="Quiz">Quiz</option>
                                <option value="Final">Final</option>
                                <option value="Deneme Sınavı">Deneme Sınavı</option>
                              </select>
                            </div>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-lg-6">
                            <div class="mb-3">
                              <label for="choices-class-level" class="form-label">Sınıf Seviyesi</label>
                              <select class="form-control" name="choices-class-level" id="choices-class-level">
                                <option value="">Sınıf seçiniz...</option>
                                <option value="9. Sınıf">9. Sınıf</option>
                                <option value="10. Sınıf">10. Sınıf</option>
                                <option value="11. Sınıf">11. Sınıf</option>
                                <option value="12. Sınıf">12. Sınıf</option>
                              </select>
                            </div>
                          </div>
                          <div class="col-lg-6">
                            <div class="mb-3">
                              <label for="choices-course" class="form-label">Ders</label>
                              <select class="form-control" name="choices-course" id="choices-course">
                                <option value="">Ders seçiniz...</option>
                                <option value="Matematik">Matematik</option>
                                <option value="Fizik">Fizik</option>
                                <option value="Kimya">Kimya</option>
                                <option value="Biyoloji">Biyoloji</option>
                                <option value="Türk Dili ve Edebiyatı">Türk Dili ve Edebiyatı</option>
                              </select>
                            </div>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-lg-6">
                            <div class="mb-3">
                              <label class="form-label">Sınav Tarihi ve Saati</label>
                              <input type="text" class="form-control" id="datepicker-datetime" placeholder="Tarih ve saat seçin...">
                            </div>
                          </div>
                        </div>
                      </form>
                      <ul class="pager wizard twitter-bs-wizard-pager-link">
                        <li class="next"><a href="javascript: void(0);" class="btn btn-primary">İleri <i class="bx bx-chevron-right ms-1"></i></a></li>
                      </ul>
                    </div>
                    <div class="tab-pane" id="add-questions">
                      <div class="text-center my-4">
                        <h5>Soru Ekleme</h5>
                        <p class="card-title-desc">Sınav sorularını ve detaylarını giriniz</p>
                      </div>
                      <form id="questions-form">
                        <div class="card border shadow-sm mb-4 question-card">
                          <div class="card-header bg-light d-flex justify-content-between align-items-center">
                            <h5 class="mb-0">Soru 1</h5>
                            <button type="button" class="btn-close" aria-label="Close"></button>
                          </div>
                          <div class="card-body">
                            <div class="mb-3">
                              <label for="question-text-1" class="form-label">Soru Metni</label>
                              <textarea id="question-text-1" class="form-control question-text" rows="3" placeholder="Soru metnini buraya yazınız..."></textarea>
                            </div>
                            <div class="row">
                              <div class="col-lg-7">
                                <label class="form-label">Seçenekler (Doğru olanı işaretleyiniz)</label>
                                <div class="mb-2 input-group">
                                  <div class="input-group-text">
                                    <input class="form-check-input correct-answer-radio" type="radio" name="correct-answer-1" value="A">
                                  </div>
                                  <span class="input-group-text">A)</span>
                                  <input type="text" class="form-control option-text" placeholder="Seçenek metni...">
                                </div>
                                <div class="mb-2 input-group">
                                  <div class="input-group-text">
                                    <input class="form-check-input correct-answer-radio" type="radio" name="correct-answer-1" value="B">
                                  </div>
                                  <span class="input-group-text">B)</span>
                                  <input type="text" class="form-control option-text" placeholder="Seçenek metni...">
                                </div>
                                <div class="mb-2 input-group">
                                  <div class="input-group-text">
                                    <input class="form-check-input correct-answer-radio" type="radio" name="correct-answer-1" value="C">
                                  </div>
                                  <span class="input-group-text">C)</span>
                                  <input type="text" class="form-control option-text" placeholder="Seçenek metni...">
                                </div>
                                <div class="mb-2 input-group">
                                  <div class="input-group-text">
                                    <input class="form-check-input correct-answer-radio" type="radio" name="correct-answer-1" value="D">
                                  </div>
                                  <span class="input-group-text">D)</span>
                                  <input type="text" class="form-control option-text" placeholder="Seçenek metni...">
                                </div>
                              </div>
                              <div class="col-lg-5">
                                <div class="mb-3">
                                  <label for="question-points-1" class="form-label">Puan Değeri</label>
                                  <input class="form-control question-points" type="number" value="10" id="question-points-1">
                                </div>
                                <div class="mb-3">
                                  <label for="question-objective-1" class="form-label">Kazanım</label>
                                  <input type="text" class="form-control question-objective" id="question-objective-1" placeholder="Örn: M.9.1.1.1.">
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </form>
                      <ul class="pager wizard twitter-bs-wizard-pager-link mt-4">
                        <li class="previous"><a href="javascript: void(0);" class="btn btn-primary"><i class="bx bx-chevron-left me-1"></i> Geri</a></li>
                        <li class="next"><a href="javascript: void(0);" class="btn btn-primary">İleri <i class="bx bx-chevron-right ms-1"></i></a></li>
                      </ul>
                    </div>
                    <div class="tab-pane" id="review-and-save">
                      <div class="text-center my-4">
                        <h5>Önizleme ve Kaydet</h5>
                        <p class="card-title-desc">Lütfen bilgilerin doğruluğunu kontrol ediniz</p>
                      </div>
                      <div class="card border">
                        <div class="card-header bg-light">
                          <h5 class="mb-0">Sınav Bilgileri</h5>
                        </div>
                        <div class="card-body">
                          <p><strong>Ders:</strong> <span id="preview-ders"></span></p>
                          <p><strong>Sınıf:</strong> <span id="preview-sinif"></span></p>
                          <p><strong>Sınav:</strong> <span id="preview-sinav-turu"></span></p>
                          <p><strong>Tarih:</strong> <span id="preview-tarih"></span></p>
                          <hr>
                          <h5 class="font-size-15">Sorular:</h5>
                          <div id="preview-soru-container">
                          </div>
                          <hr>
                          <p><strong>Toplam Soru:</strong> <span id="preview-toplam-soru"></span></p>
                          <p><strong>Toplam Puan:</strong> <span id="preview-toplam-puan"></span></p>
                        </div>
                      </div>
                      <ul class="pager wizard twitter-bs-wizard-pager-link">
                        <li class="previous"><a href="javascript: void(0);" class="btn btn-primary"><i class="bx bx-chevron-left me-1"></i> Geri</a></li>
                        <li class="float-end"><a href="javascript: void(0);" class="btn btn-success" data-bs-toggle="modal" data-bs-target=".confirmModal">Sınavı Oluştur ve Kaydet <i class="bx bx-save ms-1"></i></a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade confirmModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header border-bottom-0">
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="text-center">
              <div class="mb-3">
                <i class="bx bx-check-circle display-4 text-success"></i>
              </div>
              <h5>Sınav Başarıyla Kaydedildi!</h5>
            </div>
          </div>
          <div class="modal-footer justify-content-center">
            <button type="button" class="btn btn-primary w-md" data-bs-dismiss="modal">Harika!</button>
          </div>
        </div>
      </div>
    </div>
    <footer class="footer">
      <div class="container-fluid">
        <div class="row">
          <div class="col-sm-6">
            <script>
              document.write(new Date().getFullYear())
            </script> © E-Mentor.
          </div>
          <div class="col-sm-6">
            <div class="text-sm-end d-none d-sm-block">
              Design & Develop by <a href="#!" class="text-decoration-underline">Themesbrand</a>
            </div>
          </div>
        </div>
      </div>
    </footer>
  </div>
</div>

<script src="assets/libs/jquery/jquery.min.js"></script>
<script src="assets/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="assets/libs/metismenu/metisMenu.min.js"></script>
<script src="assets/libs/simplebar/simplebar.min.js"></script>
<script src="assets/libs/node-waves/waves.min.js"></script>
<script src="assets/libs/feather-icons/feather.min.js"></script>
<script src="assets/libs/pace-js/pace.min.js"></script>

<script src="assets/libs/choices.js/public/assets/scripts/choices.min.js"></script>

<script src="https://npmcdn.com/flatpickr/dist/l10n/tr.js"></script>

<script src="assets/libs/flatpickr/flatpickr.min.js"></script>

<script src="assets/libs/twitter-bootstrap-wizard/jquery.bootstrap.wizard.min.js"></script>
<script src="assets/libs/twitter-bootstrap-wizard/prettify.js"></script>

<script src="assets/js/app.js"></script>

<script>
  $(document).ready(function() {

    // Choices.js Kütüphanelerini Başlatma
    const termChoice = new Choices('#choices-term');
    const examTypeChoice = new Choices('#choices-exam-type');
    const classLevelChoice = new Choices('#choices-class-level');
    const courseChoice = new Choices('#choices-course');

    // Flatpickr (Tarih Seçici) Başlatma
    flatpickr('#datepicker-datetime', {
      enableTime: true,
      locale: "tr", // Türkçe dil desteği
      dateFormat: "d.m.Y H:i" // Türkiye formatı
    });

    // Form Sihirbazını Başlatma
    $('#progrss-wizard').bootstrapWizard({
      onTabShow: function(tab, navigation, index) {
        var $total = navigation.find('li').length;
        var $current = index + 1;
        var $percent = ($current / $total) * 100;
        $('#progrss-wizard .progress-bar').css({
          width: $percent + '%'
        });
      },
      // 3. adıma (önizleme) geçildiğinde çalışacak fonksiyon
      onNext: function(tab, navigation, nextIndex) {
        // Eğer bir sonraki adım önizleme adımı ise (index'i 2'dir)
        if (nextIndex === 2) {
          populatePreview();
        }
      }
    });

    // Önizleme alanını dolduran ana fonksiyon
    function populatePreview() {
      // Adım 1'deki bilgileri al ve önizlemeye yaz
      const termValue = termChoice.getValue(true);
      const examTypeValue = examTypeChoice.getValue(true);
      const classLevelValue = classLevelChoice.getValue(true);
      const courseValue = courseChoice.getValue(true);
      const dateValue = document.getElementById('datepicker-datetime').value;

      document.getElementById('preview-ders').textContent = courseValue || 'Belirtilmemiş';
      document.getElementById('preview-sinif').textContent = classLevelValue || 'Belirtilmemiş';
      document.getElementById('preview-sinav-turu').textContent = `${termValue} - ${examTypeValue}` || 'Belirtilmemiş';
      document.getElementById('preview-tarih').textContent = dateValue || 'Belirtilmemiş';

      // Adım 2'deki soruları al ve önizlemeye yaz
      const questionCards = document.querySelectorAll('.question-card');
      const previewContainer = document.getElementById('preview-soru-container');
      previewContainer.innerHTML = ''; // Önceki önizlemeyi temizle
      let totalPoints = 0;

      questionCards.forEach((card, index) => {
        const questionNumber = index + 1;
        const questionText = card.querySelector('.question-text').value;
        const questionPoints = parseInt(card.querySelector('.question-points').value, 10) || 0;
        const questionObjective = card.querySelector('.question-objective').value;

        totalPoints += questionPoints;

        // Doğru cevabın hangisi olduğunu bul
        const correctAnswerRadio = card.querySelector('.correct-answer-radio:checked');
        const correctAnswerValue = correctAnswerRadio ? correctAnswerRadio.value : null;

        let optionsHTML = '';
        const options = card.querySelectorAll('.option-text');
        const optionLabels = ['A', 'B', 'C', 'D'];

        options.forEach((option, optionIndex) => {
          const label = optionLabels[optionIndex];
          const isCorrect = (label === correctAnswerValue);
          const textClass = isCorrect ? 'text-success fw-bold' : '';
          const correctLabel = isCorrect ? ' (Doğru Cevap)' : '';
          optionsHTML += `<p class="ms-3 ${textClass}">${label}) ${option.value}${correctLabel}</p>`;
        });

        const questionHTML = `
                        <div>
                            <p><strong>Soru ${questionNumber}:</strong> ${questionText} (${questionPoints} Puan)</p>
                            <p class="ms-3 text-muted"><em>Kazanım: ${questionObjective || 'Belirtilmemiş'}</em></p>
                            ${optionsHTML}
                        </div>
                    `;
        previewContainer.innerHTML += questionHTML;
      });

      // Toplam soru ve puanı güncelle
      document.getElementById('preview-toplam-soru').textContent = questionCards.length;
      document.getElementById('preview-toplam-puan').textContent = totalPoints;
    }
  });
</script>
</body>

</html>